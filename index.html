<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>All Tools</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.0/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #fffafc;
      margin: 0; padding: 20px;
      color: #5c2c44;
    }
    header {
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 15px;
      color: #d93670;
      user-select: none;
    }
    nav {
      display: none;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin-bottom: 20px;
    }
    nav button {
      padding: 8px 14px;
      border: none;
      background: #ff80aa;
      color: white;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    nav button:hover, nav button.active {
      background: #ff4c7a;
    }
    section {
      display: none;
      max-width: 650px;
      margin: auto;
      background: #fff0f5;
      border-radius: 12px;
      box-shadow: 0 0 14px rgba(255,192,203,0.35);
      padding: 20px;
      color: #5c2c44;
    }
    section.active {
      display: block;
    }
    input, textarea, select {
      width: 100%;
      padding: 8px;
      margin-top: 8px;
      margin-bottom: 12px;
      border-radius: 6px;
      border: 1px solid #e7a5c3;
      font-size: 1rem;
      background: #fff7fb;
      color: #5c2c44;
      resize: vertical;
    }
    button.action {
      background: #ff80aa;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
    }
    button.action:hover {
      background: #ff4c7a;
    }
    ul#planList, ul#memoList {
      list-style: none;
      padding-left: 0;
      max-height: 200px;
      overflow-y: auto;
      border-top: 1px solid #f5a6c2;
    }
    ul#planList li, ul#memoList li {
      padding: 10px;
      border-bottom: 1px solid #f5a6c2;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    ul#planList li button, ul#memoList li button {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
      color: #ff4477;
    }
    #fontResultFancy, #fontResultHandwriting, #markdownPreview, #textSummaryResult, #colorPickerResult, #calculatorResult, #pdfExtractorResult {
      margin-top: 12px;
      padding: 10px;
      background: #ffe6f1;
      border-radius: 8px;
      min-height: 50px;
      font-size: 1rem;
      word-break: break-word;
    }
    #markdownInput, #pdfExtractorOutput {
      font-family: Consolas, monospace;
    }
    #videoEditor video {
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }
    #urlShortenerResult {
      margin-top: 12px;
      font-weight: 600;
      background: #ffe6f1;
      padding: 10px;
      border-radius: 8px;
    }
    #colorPicker {
      width: 100px;
      height: 40px;
      border: none;
      cursor: pointer;
    }
    #clockDisplay {
      font-size: 2.8rem;
      font-weight: 700;
      text-align: center;
      padding: 15px;
      background: #ffe6f1;
      border-radius: 12px;
      user-select: none;
    }
    #codeInput {
      height: 180px;
      font-family: Consolas, monospace;
      font-size: 1rem;
      background: #fff7fb;
      border: 2px solid #f5a6c2;
      border-radius: 8px;
      padding: 10px;
      resize: vertical;
      color: #5c2c44;
    }
    #codeOutput, #wordCountResult {
      margin-top: 10px;
      padding: 10px;
      background: #fff0f5;
      border: 2px solid #f5a6c2;
      border-radius: 8px;
      min-height: 40px;
      font-weight: 600;
      color: #5c2c44;
      white-space: pre-wrap;
      font-family: Consolas, monospace;
    }
    iframe {
      width: 100%;
      height: 300px;
      border: none;
      margin-top: 10px;
      border-radius: 8px;
    }
    #cheerMusic button {
      padding: 10px 16px;
      margin: 6px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      background-color: #0066cc;
      color: white;
      cursor: pointer;
      transition: 0.2s;
    }
    #cheerMusic button:hover {
      background-color: #004999;
      transform: scale(1.03);
    }
    #cheerMusic button:active {
      background-color: #003366;
      transform: scale(0.97);
    }
    #teamSelect {
      padding: 8px 12px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .error, .success {
      font-size: 14px;
      margin-top: 10px;
      text-align: center;
    }
    .error { color: red; }
    .success { color: green; }
    #calculator canvas {
      margin-top: 10px;
      border: 1px solid #e7a5c3;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <header>ğŸŒ¸ Main Page ğŸŒ¸</header>
  <div id="userStatus" style="text-align: center; margin-bottom: 10px; font-weight: bold;"></div>

  <section id="auth">
    <h2>ğŸ”‘ ë¡œê·¸ì¸/íšŒì›ê°€ì…</h2>
    <div id="loginForm">
      <h3>ë¡œê·¸ì¸</h3>
      <input type="text" id="loginUsername" placeholder="ì•„ì´ë””" />
      <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" />
      <button class="action" onclick="login()">ë¡œê·¸ì¸</button>
      <button class="action" onclick="showSignup()">íšŒì›ê°€ì…ìœ¼ë¡œ ì „í™˜</button>
      <div id="loginMessage" class="error"></div>
    </div>
    <div id="signupForm" style="display: none;">
      <h3>íšŒì›ê°€ì…</h3>
      <input type="text" id="signupUsername" placeholder="ì•„ì´ë””" />
      <input type="password" id="signupPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" />
      <input type="password" id="signupPasswordConfirm" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" />
      <button class="action" onclick="signup()">íšŒì›ê°€ì…</button>
      <button class="action" onclick="showLogin()">ë¡œê·¸ì¸ìœ¼ë¡œ ì „í™˜</button>
      <div id="signupMessage" class="error"></div>
    </div>
  </section>

  <nav id="navTabs">
    <button class="active" onclick="showTab('planner', this)">ğŸ“… í”Œë˜ë„ˆ</button>
    <button onclick="showTab('clock', this)">ğŸ• í˜„ì¬ì‹œê°„</button>
    <button onclick="showTab('timer', this)">â± íƒ€ì´ë¨¸</button>
    <button onclick="showTab('music', this)">ğŸµ ìŒì•…</button>
    <button onclick="showTab('memo', this)">ğŸ“ ë©”ëª¨</button>
    <button onclick="showTab('diary', this)">ğŸ“” ì¼ê¸°</button>
    <button onclick="showTab('font', this)">ğŸ”¤ í°íŠ¸ë³€í™˜</button>
    <button onclick="showTab('pngToPdf', this)">ğŸ–¼ PNG â†’ PDF ë³€í™˜ê¸°</button>
    <button onclick="showTab('score', this)">ğŸ“Š ì„±ì  ê³„ì‚°ê¸°</button>
    <button onclick="showTab('wordCount', this)">ğŸ”¢ ê¸€ììˆ˜ ì„¸ê¸°</button>
    <button onclick="showTab('markdown', this)">ğŸ“œ Markdown í¸ì§‘ê¸°</button>
    <button onclick="showTab('videoEditor', this)">ğŸ¬ ì˜ìƒ í¸ì§‘ê¸°</button>
    <button onclick="showTab('urlShortener', this)">ğŸ”— URL ë‹¨ì¶•ê¸°</button>
    <button onclick="showTab('textSummarizer', this)">âœï¸ í…ìŠ¤íŠ¸ ìš”ì•½ê¸°</button>
    <button onclick="showTab('colorPicker', this)">ğŸ¨ ì»¬ëŸ¬ í”¼ì»¤</button>
    <button onclick="showTab('calculator', this)">ğŸ§® ê³„ì‚°ê¸°</button>
    <button onclick="showTab('pdfExtractor', this)">ğŸ“„ PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ</button>
    <button onclick="showTab('cheerMusic', this)">âš¾ KBO ì‘ì›ê°€</button>
    <button onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</button>
  </nav>

  <section id="cheerMusic">
    <h2>âš¾ KBO ì‘ì›ê°€ ì¬ìƒê¸°(í‹€ì–´ì§€ëŠ”ë° 2~3ì´ˆ ê±¸ë ¤ìš”! ë²„íŠ¼ ì—°íƒ€ëŠ” ìì œí•´ì£¼ì„¸ìš”!)</h2>
    <select id="teamSelect">
      <option value="">-- íŒ€ ì„ íƒ --</option>
      <option value="doosan">ë‘ì‚°</option>
      <option value="lg">LG</option>
      <option value="kt">KT</option>
      <option value="kia">KIA</option>
      <option value="nc">NC</option>
      <option value="hanwha">í•œí™”</option>
      <option value="kiwoom">í‚¤ì›€</option>
      <option value="samsung">ì‚¼ì„±</option>
      <option value="ssg">SSG</option>
      <option value="lotte">ë¡¯ë°</option>
    </select>
    <div style="margin-top:10px;">
      <button onclick="showCheerType('team')">ğŸ¶ íŒ€ ì‘ì›ê°€</button>
      <button onclick="showCheerType('player')">ğŸµ ì„ ìˆ˜ ì‘ì›ê°€</button>
    </div>
    <div id="cheerButtons" style="margin-top:10px;"></div>
    <div id="cheerAudioPlayer"></div>
  </section>

  <section id="planner">
    <h2>ğŸ“… í”Œë˜ë„ˆ</h2>
    <input type="date" id="planDate" />
    <textarea id="planText" rows="3" placeholder="í•  ì¼ì´ë‚˜ ê³„íšì„ ì ì–´ë³´ì„¸ìš”"></textarea>
    <button class="action" onclick="addPlan()">â• ì¶”ê°€</button>
    <ul id="planList"></ul>
  </section>

  <section id="pngToPdf">
    <h2>ğŸ–¼ PNG â†’ PDF ë³€í™˜ê¸° (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</h2>
    <input type="file" id="imgInput" accept="image/png" multiple />
    <button class="action" id="convertBtn">PDF ë³€í™˜ ë° ë‹¤ìš´ë¡œë“œ</button>
  </section>

  <section id="clock">
    <h2>ğŸ• í˜„ì¬ì‹œê°„</h2>
    <div id="clockTime" style="font-size:2rem; font-weight:bold;"></div>
    <div id="clockDate" style="font-size:1.2rem; color:#666;"></div>
  </section>

  <section id="timer">
    <h2>â± íƒ€ì´ë¨¸</h2>
    <div style="display:flex; gap:10px; flex-wrap: wrap;">
      <select id="timerHours" title="ì‹œê°„"></select>
      <select id="timerMinutes" title="ë¶„"></select>
      <select id="timerSeconds" title="ì´ˆ"></select>
    </div>
    <button class="action" id="timerStartBtn" onclick="startTimer()">â–¶ ì‹œì‘</button>
    <button class="action" id="timerStopBtn" onclick="stopTimer()" disabled>â–  ì •ì§€</button>
    <div id="timerDisplay" style="font-size:2rem; font-weight:bold; margin-top:10px; user-select:none;">00:00:00</div>
  </section>

  <section id="music">
    <h2>ğŸµ ìŒì•… ì¬ìƒê¸°</h2>
    <input type="text" id="musicInput" placeholder="ìœ íŠœë¸Œ ë§í¬ ë˜ëŠ” MP3 URLì„ ì…ë ¥í•˜ì„¸ìš”" />
    <button class="action" onclick="playMusic()">â–¶ï¸ ì¬ìƒ</button>
    <div id="musicPlayer" style="margin-top: 15px;"></div>
  </section>

  <section id="videodown">
    <h2>ğŸ“¥ ì˜ìƒ ë‹¤ìš´ë¡œë“œ</h2>
    <input type="text" id="videoUrl" placeholder="ë„¤ì´ë²„, ìœ íŠœë¸Œ, ê¸°íƒ€ ë™ì˜ìƒ ë§í¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
    <button class="action" onclick="downloadVideo()">â¬‡ï¸ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±</button>
    <div id="videoLink" style="margin-top: 15px;"></div>
  </section>

  <section id="score">
    <h2>ğŸ“Š ì„±ì  ê³„ì‚°ê¸°</h2>
    <div class="score-group">
      <label>ìˆ˜í–‰í‰ê°€ ì ìˆ˜ (0~100)</label>
      <input type="number" id="scorePerform" min="0" max="100" value="0" />
      <label>ìˆ˜í–‰í‰ê°€ ë°˜ì˜ë¹„ìœ¨ (%)</label>
      <input type="number" id="weightPerform" min="0" max="100" value="20" />
    </div>
    <div class="score-group">
      <label>ì¤‘ê°„ê³ ì‚¬ ì ìˆ˜ (0~100)</label>
      <input type="number" id="scoreMid" min="0" max="100" value="0" />
      <label>ì¤‘ê°„ê³ ì‚¬ ë°˜ì˜ë¹„ìœ¨ (%)</label>
      <input type="number" id="weightMid" min="0" max="100" value="40" />
    </div>
    <div class="score-group">
      <label>ëª©í‘œ ì ìˆ˜ (0~100)</label>
      <input type="number" id="scoreFinalGoal" min="0" max="100" value="80" />
      <label>ê¸°ë§ê³ ì‚¬ ë°˜ì˜ë¹„ìœ¨ (%)</label>
      <input type="number" id="weightFinal" min="0" max="100" value="40" />
    </div>
    <button class="action" onclick="calcScore()">ê³„ì‚°í•˜ê¸°</button>
    <div id="scoreResult" style="margin-top: 15px; font-weight: 700;"></div>
    <div id="error" class="error"></div>
  </section>

  <section id="memo">
    <h2>ğŸ“ ë©”ëª¨ì¥</h2>
    <textarea id="memoText" rows="8" placeholder="ê°ì„± ìˆê²Œ ë©”ëª¨ë¥¼ ì ì–´ë³´ì„¸ìš”..."></textarea>
    <button class="action" onclick="saveMemo()">ğŸ’¾ ì €ì¥</button>
    <button class="action" onclick="downloadMemo()">ğŸ“¥ TXTë¡œ ì €ì¥</button>
    <ul id="memoList"></ul>
  </section>

  <section id="diary">
    <h2>ğŸ“” ì¼ê¸°</h2>
    <textarea id="diaryText" rows="10" placeholder="ì˜¤ëŠ˜ì˜ ì¼ê¸°ë¥¼ ê°ì„±ì ìœ¼ë¡œ ì ì–´ë³´ì„¸ìš”..."></textarea>
    <button class="action" onclick="saveDiary()">ğŸ’¾ ì €ì¥</button>
    <button class="action" onclick="downloadDiary()">ğŸ“¥ PNGë¡œ ìº¡ì³ ì €ì¥</button>
  </section>

  <section id="font">
    <h2>ğŸ”¤ í°íŠ¸ ë³€í™˜ê¸°</h2>
    <textarea id="fontInput" placeholder="ì…ë ¥í•˜ì„¸ìš”" rows="3"></textarea>
    <div style="margin-top: 10px;">
      <p><strong>íŒ¬ì‹œì²´:</strong></p>
      <div id="fontResultFancy" style="border: 1px solid #ccc; padding: 10px; font-size: 18px;"></div>
      <button class="action" onclick="copyFancy()">ë³µì‚¬</button>
    </div>
    <div style="margin-top: 10px;">
      <p><strong>í•„ê¸°ì²´ (Cursive):</strong></p>
      <div id="fontResultHandwriting" style="border: 1px solid #ccc; padding: 10px; font-family: cursive; font-size: 18px;"></div>
      <button class="action" onclick="copyHandwriting()">ë³µì‚¬</button>
    </div>
  </section>

  <section id="code">
    <h2>ğŸ’» HTML ì½”ë“œ í…ŒìŠ¤íŠ¸</h2>
    <textarea id="codeInput" placeholder="HTML ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    <button class="action" onclick="runCode()">ì‹¤í–‰</button>
    <button class="action" onclick="checkCode()">ë¬¸ë²• ê²€ì‚¬</button>
    <div id="codeOutput"></div>
    <iframe id="codeFrame"></iframe>
  </section>

  <section id="wordCount">
    <h2>ğŸ”¢ ê¸€ììˆ˜ ì„¸ê¸°</h2>
    <textarea id="wordCountInput" rows="8" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
    <div id="wordCountResult"></div>
  </section>

  <section id="markdown">
    <h2>ğŸ“œ Markdown í¸ì§‘ê¸°</h2>
    <textarea id="markdownInput" rows="8" placeholder="Markdown í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: # ì œëª©, **êµµì€ í…ìŠ¤íŠ¸**)"></textarea>
    <button class="action" onclick="saveMarkdown()">ğŸ’¾ ì €ì¥</button>
    <button class="action" onclick="downloadMarkdown()">ğŸ“¥ HTMLë¡œ ë‹¤ìš´ë¡œë“œ</button>
    <div id="markdownPreview"></div>
  </section>

  <section id="videoEditor">
    <h2>ğŸ¬ ì˜ìƒ í¸ì§‘ê¸°</h2>
    <input type="file" id="videoInput" accept="video/mp4" />
    <div style="display:flex; gap:10px; flex-wrap: wrap;">
      <input type="number" id="videoStart" placeholder="ì‹œì‘ ì‹œê°„ (ì´ˆ)" min="0" step="1" />
      <input type="number" id="videoDuration" placeholder="ê¸¸ì´ (ì´ˆ)" min="1" step="1" />
    </div>
    <button class="action" onclick="trimVideo()">âœ‚ï¸ ìë¥´ê¸°</button>
    <video id="videoPreview" controls></video>
  </section>

  <section id="urlShortener">
    <h2>ğŸ”— URL ë‹¨ì¶•ê¸°</h2>
    <input type="text" id="urlInput" placeholder="ê¸´ URLì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: https://example.com)" />
    <button class="action" onclick="shortenUrl()">ğŸ”— ë‹¨ì¶•í•˜ê¸°</button>
    <div id="urlShortenerResult"></div>
  </section>

  <section id="textSummarizer">
    <h2>âœï¸ í…ìŠ¤íŠ¸ ìš”ì•½ê¸°</h2>
    <textarea id="textSummaryInput" rows="8" placeholder="ìš”ì•½í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
    <button class="action" onclick="summarizeText()">âœï¸ ìš”ì•½í•˜ê¸°</button>
    <div id="textSummaryResult"></div>
  </section>

  <section id="colorPicker">
    <h2>ğŸ¨ ì»¬ëŸ¬ í”¼ì»¤</h2>
    <input type="color" id="colorPickerInput" value="#ff80aa" />
    <button class="action" onclick="saveColor()">ğŸ’¾ ìƒ‰ìƒ ì €ì¥</button>
    <div id="colorPickerResult"></div>
  </section>

  <section id="calculator">
    <h2>ğŸ§® ê³„ì‚°ê¸°</h2>
    <h3>ì¼ì°¨ë°©ì •ì‹ (ax + b = c)</h3>
    <div style="display:flex; gap:10px; flex-wrap: wrap;">
      <input type="number" id="linearA" placeholder="a" step="any" />
      <input type="number" id="linearB" placeholder="b" step="any" />
      <input type="number" id="linearC" placeholder="c" step="any" />
    </div>
    <button class="action" onclick="solveLinear()">ê³„ì‚°</button>
    <h3>ì—°ë¦½ë°©ì •ì‹ (a1x + b1y = c1, a2x + b2y = c2)</h3>
    <div style="display:flex; gap:10px; flex-wrap: wrap;">
      <input type="number" id="systemA1" placeholder="a1" step="any" />
      <input type="number" id="systemB1" placeholder="b1" step="any" />
      <input type="number" id="systemC1" placeholder="c1" step="any" />
      <input type="number" id="systemA2" placeholder="a2" step="any" />
      <input type="number" id="systemB2" placeholder="b2" step="any" />
      <input type="number" id="systemC2" placeholder="c2" step="any" />
    </div>
    <button class="action" onclick="solveSystem()">ê³„ì‚°</button>
    <h3>ì¼ì°¨í•¨ìˆ˜ (y = mx + b)</h3>
    <div style="display:flex; gap:10px; flex-wrap: wrap;">
      <input type="number" id="functionM" placeholder="ê¸°ìš¸ê¸° m" step="any" />
      <input type="number" id="functionB" placeholder="ì ˆí¸ b" step="any" />
    </div>
    <button class="action" onclick="plotFunction()">ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</button>
    <canvas id="functionGraph" width="400" height="300"></canvas>
    <div id="calculatorResult"></div>
  </section>

  <section id="pdfExtractor">
    <h2>ğŸ“„ PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ</h2>
    <input type="file" id="pdfInput" accept="application/pdf" />
    <button class="action" onclick="extractPdfText()">ğŸ“ í…ìŠ¤íŠ¸ ì¶”ì¶œ</button>
    <button class="action" onclick="savePdfText()">ğŸ’¾ ì €ì¥</button>
    <button class="action" onclick="downloadPdfText()">ğŸ“¥ TXTë¡œ ë‹¤ìš´ë¡œë“œ</button>
    <textarea id="pdfExtractorOutput" rows="8" placeholder="ì¶”ì¶œëœ í…ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤..."></textarea>
    <div id="pdfExtractorResult"></div>
  </section>

  <script>
    const cheerDatabase = {
           doosan: {
        team: { "ë‘ì‚°ì˜ ìŠ¹ë¦¬ë¥¼ ìœ„í•˜ì—¬": "https://www.youtube.com/embed/tdExcryGxiY", "í•´ì•¼í•´ì•¼": "https://www.youtube.com/watch?v=ziOAmkOwE0U", "ë‘ì‚° ìŠ¹ë¦¬í•˜ë¦¬ë¼": "https://www.youtube.com/watch?v=WO9dxDlKVSI", "í•´ì•¼": "https://www.youtube.com/watch?v=bL8jo7-TdlY", "ì•¼ì•¼ì•¼ ë‘ì‚°": "https://www.youtube.com/watch?v=lU9X9EBDemA", "ì„œìš¸ë‘ì‚° ìŠ¹ë¦¬í•˜ë¦¬ë¼": "https://www.youtube.com/watch?v=oTPJjtJoiOI", "ìš°ë¦¬ì˜ ë² ì–´ìŠ¤": "https://www.youtube.com/watch?v=ykUpQAvo3Og", "ë¸Œë¼ë³´ ë§ˆì´ ë¼ì´í”„": "https://www.youtube.com/watch?v=h_lcSkIP0Fs", "ë¼ì¸ì—…ì†¡": "https://www.youtube.com/watch?v=ebgedBJoUZw", "í’€ì¹´ìš´íŠ¸": "https://www.youtube.com/embed/TMMrp1ZtijU","ì•„íŒŒíŠ¸": "https://www.youtube.com/embed/yPDAPGJqLEk"},
        player: { "ê¹€ì¬í™˜": "https://www.youtube.com/watch?v=odb1s-BeBoQ", "ì–‘ì˜ì§€": "https://www.youtube.com/watch?v=rUxLP1UY96c", "ì •ìˆ˜ë¹ˆ": "https://www.youtube.com/watch?v=cHooEa52lBc", "ì˜¤ëª…ì§„": "https://www.youtube.com/shorts/CoWU2YYs0_4", "ì´ìœ ì°¬": "https://www.youtube.com/watch?v=CLO2jMMRdaE", "ê¹€ê¸°ì—°": "https://www.youtube.com/watch?v=XzcUZNCktxM", "ì¼€ì´ë¸Œ": "https://www.youtube.com/watch?v=U4qaRHyh-f4", "ê¹€ë¯¼ì„": "https://www.youtube.com/watch?v=J4u5gqmAh6E", "ë°•ê³„ë²”": "https://www.youtube.com/watch?v=NCkiQtY6qOI", "ê°•ìŠ¹í˜¸": "https://www.youtube.com/watch?v=C3GNdhBdaLc", "ì–‘ì„í™˜": "https://www.youtube.com/watch?v=LilrYc7XetQ", "ì¡°ìˆ˜í–‰": "https://www.youtube.com/watch?v=sFWExX_PwaE" }
        
      },
            lg: {
        team: { "ì„œìš¸ì˜ ì•„ë¦¬ì•„": "https://www.youtube.com/watch?v=jw8s-iBysmM", "ìŠ¹ë¦¬ì˜ ë…¸ë˜": "https://www.youtube.com/watch?v=8TQJyPZ5oI8&t=11s", "ìµœí›„ì˜ ê²°íˆ¬": "https://www.youtube.com/watch?v=XnKnVLFbTzY", "ê¹ƒë°œì†¡": "https://www.youtube.com/watch?v=Igv4eJRFqyY", "ë¼ì¸ì—…ì†¡": "https://www.youtube.com/watch?v=Wa0BSFPL8IM", "í¬ì—ë²„": "https://www.youtube.com/watch?v=HnlmZTypguY" },
        player: { "ë°•í•´ë¯¼": "https://www.youtube.com/watch?v=lCHHshG-yT4", "ì˜¤ìŠ¤í‹´": "https://www.youtube.com/watch?v=T9axwXZCZ2U", "ë°•ë™ì›": "https://www.youtube.com/watch?v=3h8Z2oFAcY0", "ë¬¸ì„±ì£¼": "https://www.youtube.com/watch?v=6BiMK0vvsc8", "ì‹ ë¯¼ì¬": "https://www.youtube.com/watch?v=Y1MEORELEFg", "ë¬¸ë³´ê²½": "https://www.youtube.com/watch?v=1Q5ywecUrT8", "ê¹€í˜„ìˆ˜": "https://www.youtube.com/watch?v=JTzVZio-Iqw", "êµ¬ë³¸í˜": "https://www.youtube.com/watch?v=6raFPRdbEe8", "ë¬¸ì •ë¹ˆ": "https://www.youtube.com/watch?v=vH-QEneLB2k" }
      },
      kt: {
        team: { "ë§ˆë²•ì˜ ì„±": "https://www.youtube.com/watch?v=my3RvhgBXiE", "ìœ„ë‹KT": "https://www.youtube.com/watch?v=149VoH6z9ig" },
        player: { "ë¡œí•˜ìŠ¤": "https://www.youtube.com/watch?v=nxH5VWainEo","ì•ˆí˜„ë¯¼":"https://www.youtube.com/watch?v=aQllgztqdTU"}
      },
      kia: {
        team: { "KIA íƒ€ì´ê±°ì¦ˆ ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_kia_team" },
        player: { "ì´ì˜ë¦¬": "https://www.youtube.com/watch?v=example_kia_player" }
      },
      nc: {
        team: { "NC ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_nc_team" },
        player: { "?": "https://www.youtube.com/watch?v=TfWltglBGgA" }
      },
      hanwha: {
        team: { "í•œí™” ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_han_team" },
        player: { "ìµœì§„í–‰": "https://www.youtube.com/watch?v=example_han_player" }
      },
      kiwoom: {
        team: { "í‚¤ì›€ ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_kiwoom_team" },
        player: { "ê³ ì¢…ìš±": "https://www.youtube.com/watch?v=example_kiwoom_player" }
      },
      samsung: {
        team: { "ì‚¼ì„± ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_sam_team" },
        player: { "ì´ì›ì„": "https://www.youtube.com/watch?v=example_sam_player" }
      },
      ssg: {
        team: { "SSG ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_ssg_team" },
        player: { "ìµœì •": "https://www.youtube.com/watch?v=example_ssg_player" }
      },
      lotte: {
        team: { "ë¡¯ë° ì‘ì›ê°€": "https://www.youtube.com/watch?v=example_lotte_team" },
        player: { "ì†ì•„ì„­": "https://www.youtube.com/watch?v=example_lotte_player" }
      }
    };

    function showCheerType(type) {
      const team = document.getElementById('teamSelect').value;
      const cheerButtons = document.getElementById('cheerButtons');
      cheerButtons.innerHTML = '';
      document.getElementById('cheerAudioPlayer').innerHTML = '';
      if (!team) {
        alert('ë¨¼ì € íŒ€ì„ ì„ íƒí•˜ì„¸ìš”!');
        return;
      }
      const data = cheerDatabase[team]?.[type];
      if (!data) {
        cheerButtons.textContent = 'ì‘ì›ê°€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
        return;
      }
      for (const title in data) {
        const btn = document.createElement('button');
        btn.textContent = title;
        btn.onclick = () => playCheer(data[title]);
        cheerButtons.appendChild(btn);
      }
    }

    function playCheer(link) {
  const player = document.getElementById('cheerAudioPlayer');
  player.innerHTML = '';
  const iframe = document.createElement('iframe');

  try {
    let embedLink = '';

    if (link.includes('/embed/')) {
      embedLink = link;
    } else if (link.includes('/shorts/')) {
      const videoId = link.split('/shorts/')[1].split(/[?&]/)[0];
      embedLink = `https://www.youtube.com/embed/${videoId}`;
    } else if (link.includes('watch?v=')) {
      const url = new URL(link);
      const id = url.searchParams.get('v');
      embedLink = `https://www.youtube.com/embed/${id}`;
    } else {
      alert('ìœ íš¨í•œ ìœ íŠœë¸Œ ë§í¬ê°€ ì•„ë‹™ë‹ˆë‹¤.');
      return;
    }

    iframe.src = `${embedLink}?autoplay=1&mute=0`;
    iframe.allow = "autoplay";
    iframe.style = "width:0;height:0;border:0;display:none;";
    player.appendChild(iframe);

  } catch (e) {
    alert('ë§í¬ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: ' + e.message);
  }
}


    // ë¡œê·¸ì¸/íšŒì›ê°€ì…
    function checkLoginStatus() {
      const loggedInUser = localStorage.getItem('loggedInUser');
      const userStatus = document.getElementById('userStatus');
      const navTabs = document.getElementById('navTabs');
      const authSection = document.getElementById('auth');
      const contentSections = document.querySelectorAll('section:not(#auth)');

      if (loggedInUser) {
        userStatus.textContent = `${loggedInUser}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`;
        navTabs.style.display = 'flex';
        authSection.style.display = 'none';
        contentSections.forEach(s => s.style.display = s.id === 'planner' ? 'block' : 'none');
        document.querySelector('nav button[onclick*="planner"]').classList.add('active');
      } else {
        userStatus.textContent = '';
        navTabs.style.display = 'none';
        authSection.style.display = 'block';
        contentSections.forEach(s => s.style.display = 'none');
      }
    }

    function showLogin() {
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('signupForm').style.display = 'none';
      document.getElementById('loginMessage').textContent = '';
      document.getElementById('signupMessage').textContent = '';
    }

    function showSignup() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('signupForm').style.display = 'block';
      document.getElementById('loginMessage').textContent = '';
      document.getElementById('signupMessage').textContent = '';
    }

    function signup() {
      const username = document.getElementById('signupUsername').value.trim();
      const password = document.getElementById('signupPassword').value;
      const passwordConfirm = document.getElementById('signupPasswordConfirm').value;
      const messageDiv = document.getElementById('signupMessage');

      if (!username || !password || !passwordConfirm) {
        messageDiv.textContent = 'ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        return;
      }
      if (password !== passwordConfirm) {
        messageDiv.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
        return;
      }

      const users = JSON.parse(localStorage.getItem('users') || '{}');
      if (users[username]) {
        messageDiv.textContent = 'ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.';
        return;
      }

      users[username] = password;
      localStorage.setItem('users', JSON.stringify(users));
      messageDiv.className = 'success';
      messageDiv.textContent = 'íšŒì›ê°€ì… ì„±ê³µ! ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.';
      showLogin();
    }

    function login() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value;
      const messageDiv = document.getElementById('loginMessage');

      if (!username || !password) {
        messageDiv.textContent = 'ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        return;
      }

      const users = JSON.parse(localStorage.getItem('users') || '{}');
      if (users[username] && users[username] === password) {
        localStorage.setItem('loggedInUser', username);
        messageDiv.className = 'success';
        messageDiv.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ!';
        checkLoginStatus();
      } else {
        messageDiv.textContent = 'ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.';
      }
    }

    function logout() {
      localStorage.removeItem('loggedInUser');
      checkLoginStatus();
    }

    // íƒ­ ì „í™˜
    function showTab(id, btn) {
      if (!localStorage.getItem('loggedInUser')) {
        document.getElementById('auth').style.display = 'block';
        document.querySelectorAll('section:not(#auth)').forEach(s => s.style.display = 'none');
        document.getElementById('navTabs').style.display = 'none';
        document.getElementById('userStatus').textContent = '';
        return;
      }
      document.querySelectorAll('section').forEach(s => s.style.display = 'none');
      document.getElementById(id).style.display = 'block';
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }

    // í”Œë˜ë„ˆ
    const STORAGE_PLANNER = 'myPersonalPlanner';
    function loadPlans() {
      const plans = JSON.parse(localStorage.getItem(STORAGE_PLANNER) || '[]');
      const ul = document.getElementById('planList');
      ul.innerHTML = '';
      plans.forEach(({date, text}, i) => {
        const li = document.createElement('li');
        li.textContent = `${date} - ${text}`;
        const delBtn = document.createElement('button');
        delBtn.textContent = 'âŒ';
        delBtn.title = 'ì‚­ì œ';
        delBtn.onclick = () => removePlan(i);
        li.appendChild(delBtn);
        ul.appendChild(li);
      });
    }
    function addPlan() {
      const date = document.getElementById('planDate').value;
      const text = document.getElementById('planText').value.trim();
      if (!date || !text) {
        alert('ë‚ ì§œì™€ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }
      const plans = JSON.parse(localStorage.getItem(STORAGE_PLANNER) || '[]');
      plans.push({date, text});
      localStorage.setItem(STORAGE_PLANNER, JSON.stringify(plans));
      document.getElementById('planText').value = '';
      loadPlans();
    }
    function removePlan(index) {
      const plans = JSON.parse(localStorage.getItem(STORAGE_PLANNER) || '[]');
      plans.splice(index, 1);
      localStorage.setItem(STORAGE_PLANNER, JSON.stringify(plans));
      loadPlans();
    }

    // í˜„ì¬ì‹œê°„
    function updateClock() {
      const now = new Date();
      const h = now.getHours().toString().padStart(2, '0');
      const m = now.getMinutes().toString().padStart(2, '0');
      const s = now.getSeconds().toString().padStart(2, '0');
      const year = now.getFullYear();
      const month = (now.getMonth() + 1).toString().padStart(2, '0');
      const date = now.getDate().toString().padStart(2, '0');
      const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
      const day = dayNames[now.getDay()];
      const dateStr = `${year}ë…„ ${month}ì›” ${date}ì¼ (${day})`;
      document.getElementById('clockTime').textContent = `${h}:${m}:${s}`;
      document.getElementById('clockDate').textContent = dateStr;
    }
    setInterval(updateClock, 1000);

    // íƒ€ì´ë¨¸
    let timerInterval;
    function startTimer() {
      const h = parseInt(document.getElementById('timerHours').value);
      const m = parseInt(document.getElementById('timerMinutes').value);
      const s = parseInt(document.getElementById('timerSeconds').value);
      let total = h * 3600 + m * 60 + s;
      if (total <= 0) {
        alert('0ì´ˆë³´ë‹¤ í° ì‹œê°„ì„ ì„ íƒí•˜ì„¸ìš”.');
        return;
      }
      document.getElementById('timerStartBtn').disabled = true;
      document.getElementById('timerStopBtn').disabled = false;
      timerInterval = setInterval(() => {
        if (total <= 0) {
          clearInterval(timerInterval);
          alert('â° íƒ€ì´ë¨¸ ì¢…ë£Œ!');
          document.getElementById('timerDisplay').textContent = '00:00:00';
          document.getElementById('timerStartBtn').disabled = false;
          document.getElementById('timerStopBtn').disabled = true;
          return;
        }
        total--;
        const hh = Math.floor(total / 3600).toString().padStart(2, '0');
        const mm = Math.floor((total % 3600) / 60).toString().padStart(2, '0');
        const ss = (total % 60).toString().padStart(2, '0');
        document.getElementById('timerDisplay').textContent = `${hh}:${mm}:${ss}`;
      }, 1000);
    }
    function stopTimer() {
      clearInterval(timerInterval);
      document.getElementById('timerStartBtn').disabled = false;
      document.getElementById('timerStopBtn').disabled = true;
    }
    function fillTimerSelects() {
      const timerHours = document.getElementById('timerHours');
      const timerMinutes = document.getElementById('timerMinutes');
      const timerSeconds = document.getElementById('timerSeconds');
      function fillSelectOptions(select, max) {
        for (let i = 0; i <= max; i++) {
          const opt = document.createElement('option');
          opt.value = i;
          opt.textContent = `${i} ${select.title}`;
          select.appendChild(opt);
        }
      }
      timerHours.innerHTML = '';
      timerMinutes.innerHTML = '';
      timerSeconds.innerHTML = '';
      fillSelectOptions(timerHours, 24);
      fillSelectOptions(timerMinutes, 60);
      fillSelectOptions(timerSeconds, 60);
      timerHours.value = 0;
      timerMinutes.value = 0;
      timerSeconds.value = 0;
    }

    // ìŒì•… ì¬ìƒê¸°
    function playMusic() {
      const input = document.getElementById('musicInput').value.trim();
      const player = document.getElementById('musicPlayer');
      player.innerHTML = '';
      if (!input) {
        alert('ìœ íŠœë¸Œ ë§í¬ ë˜ëŠ” MP3 URLì„ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }
      let ytId = null;
      if (input.includes('youtu.be/')) {
        ytId = input.split('youtu.be/')[1].split(/[?&]/)[0];
      } else if (input.includes('youtube.com/watch')) {
        const urlParams = new URLSearchParams(input.split('?')[1]);
        ytId = urlParams.get('v');
      }
      if (ytId) {
        const iframe = document.createElement('iframe');
        iframe.src = `https://www.youtube.com/embed/${ytId}?autoplay=1`;
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
        iframe.allowFullscreen = true;
        player.appendChild(iframe);
        return;
      }
      if (input.match(/^https?:\/\/.*\.(mp3|wav|ogg)$/i)) {
        const audio = document.createElement('audio');
        audio.controls = true;
        audio.src = input;
        audio.autoplay = true;
        player.appendChild(audio);
        return;
      }
      alert('ìœ íŠœë¸Œ ë§í¬ë‚˜ MP3/WAV/OGG URLë§Œ ì§€ì›í•©ë‹ˆë‹¤.');
    }

    // ì˜ìƒ ë‹¤ìš´ë¡œë“œ
    function downloadVideo() {
      const url = document.getElementById('videoUrl').value.trim();
      const linkBox = document.getElementById('videoLink');
      linkBox.innerHTML = '';
      if (!url) {
        alert('ë™ì˜ìƒ ë§í¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }
      const a = document.createElement('a');
      a.href = url;
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      a.textContent = 'ë‹¤ìš´ë¡œë“œ ì‹œë„ ë§í¬ (ìƒˆ ì°½ ì—´ë¦¼)';
      a.style = 'color:#d93670; font-weight:bold; font-size:1.1rem;';
      linkBox.appendChild(a);
    }

    // ì„±ì  ê³„ì‚°ê¸°
    function calcScore() {
      const performanceScore = parseFloat(document.getElementById('scorePerform').value);
      const midtermScore = parseFloat(document.getElementById('scoreMid').value);
      const performanceWeight = parseFloat(document.getElementById('weightPerform').value) / 100;
      const midtermWeight = parseFloat(document.getElementById('weightMid').value) / 100;
      const finalWeight = parseFloat(document.getElementById('weightFinal').value) / 100;
      const targetScore = parseFloat(document.getElementById('scoreFinalGoal').value);

      const resultDiv = document.getElementById('scoreResult');
      const errorDiv = document.getElementById('error');

      errorDiv.textContent = '';
      resultDiv.style.display = 'none';

      if (isNaN(performanceScore) || isNaN(midtermScore) || isNaN(performanceWeight) || 
          isNaN(midtermWeight) || isNaN(finalWeight) || isNaN(targetScore)) {
        errorDiv.textContent = 'ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        return;
      }

      if (performanceScore < 0 || performanceScore > 100 || 
          midtermScore < 0 || midtermScore > 100 || 
          targetScore < 0 || targetScore > 100) {
        errorDiv.textContent = 'ì ìˆ˜ëŠ” 0ì—ì„œ 100 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.';
        return;
      }

      if (Math.abs(performanceWeight + midtermWeight + finalWeight - 1) > 0.01) {
        errorDiv.textContent = 'ë°˜ì˜ë¹„ìœ¨ì˜ í•©ì€ 100%ì—¬ì•¼ í•©ë‹ˆë‹¤.';
        return;
      }

      const maxScore = (performanceScore * performanceWeight) + 
                       (midtermScore * midtermWeight) + 
                       (100 * finalWeight);

      const requiredFinal = (targetScore - (performanceScore * performanceWeight) - 
                            (midtermScore * midtermWeight)) / finalWeight;

      resultDiv.innerHTML = `
        ê²°ê³¼:<br>
        ê¸°ë§ê³ ì‚¬ì—ì„œ 100ì ì„ ë§ì„ ê²½ìš° ìµœì¢… ì ìˆ˜: ${maxScore.toFixed(2)}ì <br>
        ëª©í‘œ ì ìˆ˜ (${targetScore}ì )ë¥¼ ë‹¬ì„±í•˜ë ¤ë©´ ê¸°ë§ê³ ì‚¬ì—ì„œ í•„ìš”í•œ ì ìˆ˜: 
        ${requiredFinal < 0 ? '0' : requiredFinal.toFixed(2)}ì 
      `;
      resultDiv.style.display = 'block';
    }

    // ë©”ëª¨
    const STORAGE_MEMO = 'myMemo';
    function loadMemo() {
      const memo = localStorage.getItem(STORAGE_MEMO);
      if (memo) document.getElementById('memoText').value = memo;
      updateMemoList();
    }
    function saveMemo() {
      const val = document.getElementById('memoText').value;
      localStorage.setItem(STORAGE_MEMO, val);
      updateMemoList();
      alert('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    function updateMemoList() {
      const ul = document.getElementById('memoList');
      ul.innerHTML = '';
      const val = localStorage.getItem(STORAGE_MEMO);
      if (!val) return;
      const lines = val.split('\n').filter(l => l.trim());
      lines.forEach((line, i) => {
        const li = document.createElement('li');
        li.textContent = line;
        const delBtn = document.createElement('button');
        delBtn.textContent = 'âŒ';
        delBtn.title = 'ë¼ì¸ ì‚­ì œ';
        delBtn.onclick = () => {
          lines.splice(i, 1);
          localStorage.setItem(STORAGE_MEMO, lines.join('\n'));
          updateMemoList();
          document.getElementById('memoText').value = lines.join('\n');
        };
        li.appendChild(delBtn);
        ul.appendChild(li);
      });
    }
    function downloadMemo() {
      const text = document.getElementById('memoText').value;
      if (!text) {
        alert('ì €ì¥í•  ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      const blob = new Blob([text], {type:'text/plain'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `memo_${new Date().toISOString().slice(0,10)}.txt`;
      a.click();
    }

    // ì¼ê¸°
    const STORAGE_DIARY = 'myDiary';
    function loadDiary() {
      const val = localStorage.getItem(STORAGE_DIARY);
      if (val) document.getElementById('diaryText').value = val;
    }
    function saveDiary() {
      const val = document.getElementById('diaryText').value;
      localStorage.setItem(STORAGE_DIARY, val);
      alert('ì¼ê¸°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    function downloadDiary() {
      const text = document.getElementById('diaryText').value;
      if (!text) {
        alert('ì €ì¥ëœ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      const canvas = document.createElement('canvas');
      canvas.width = 600;
      canvas.height = 400;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#fff0f5';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#5c2c44';
      ctx.font = '18px "Segoe UI", Tahoma, Geneva, Verdana, sans-serif';
      ctx.textBaseline = 'top';
      const words = text.split('\n');
      let y = 20;
      for (let w of words) {
        ctx.fillText(w, 20, y);
        y += 26;
      }
      const link = document.createElement('a');
      link.href = canvas.toDataURL('image/png');
      link.download = `diary_${new Date().toISOString().slice(0,10)}.png`;
      link.click();
    }

    // í°íŠ¸ ë³€í™˜ê¸°
    const fontMapFancy = {
      A: 'ğ”„', B: 'ğ”…', C: 'â„­', D: 'ğ”‡', E: 'ğ”ˆ', F: 'ğ”‰', G: 'ğ”Š',
      H: 'â„Œ', I: 'â„‘', J: 'ğ”', K: 'ğ”', L: 'ğ”', M: 'ğ”', N: 'ğ”‘',
      O: 'ğ”’', P: 'ğ”“', Q: 'ğ””', R: 'â„œ', S: 'ğ”–', T: 'ğ”—', U: 'ğ”˜',
      V: 'ğ”™', W: 'ğ”š', X: 'ğ”›', Y: 'ğ”œ', Z: 'â„¨',
      a: 'ğ”', b: 'ğ”Ÿ', c: 'ğ” ', d: 'ğ”¡', e: 'ğ”¢', f: 'ğ”£', g: 'ğ”¤',
      h: 'ğ”¥', i: 'ğ”¦', j: 'ğ”§', k: 'ğ”¨', l: 'ğ”©', m: 'ğ”ª', n: 'ğ”«',
      o: 'ğ”¬', p: 'ğ”­', q: 'ğ”®', r: 'ğ”¯', s: 'ğ”°', t: 'ğ”±', u: 'ğ”²',
      v: 'ğ”³', w: 'ğ”´', x: 'ğ”µ', y: 'ğ”¶', z: 'ğ”·'
    };
    const fontMapHandwriting = {
      A: 'ğ“', B: 'ğ“‘', C: 'ğ“’', D: 'ğ““', E: 'ğ“”', F: 'ğ“•', G: 'ğ“–',
      H: 'ğ“—', I: 'ğ“˜', J: 'ğ“™', K: 'ğ“š', L: 'ğ“›', M: 'ğ“œ', N: 'ğ“',
      O: 'ğ“', P: 'ğ“Ÿ', Q: 'ğ“ ', R: 'ğ“¡', S: 'ğ“¢', T: 'ğ“£', U: 'ğ“¤',
      V: 'ğ“¥', W: 'ğ“¦', X: 'ğ“§', Y: 'ğ“¸', Z: 'ğ“©',
      a: 'ğ“ª', b: 'ğ“«', c: 'ğ“¬', d: 'ğ“­', e: 'ğ“®', f: 'ğ“¯', g: 'ğ“·',
      h: 'ğ“±', i: 'ğ“²', j: 'ğ“³', k: 'ğ“´', l: 'ğ“µ', m: 'ğ“¶', n: 'ğ“·',
      o: 'ğ“¸', p: 'ğ“¹', q: 'ğ“º', r: 'ğ“»', s: 'ğ“¼', t: 'ğ“½', u: 'ğ“¾',
      v: 'ğ“¿', w: 'ğ”€', x: 'ğ”', y: 'ğ”‚', z: 'ğ”ƒ'
    };
    document.getElementById('fontInput').addEventListener('input', e => {
      const txt = e.target.value;
      let fancy = '';
      for (const ch of txt) {
        fancy += fontMapFancy[ch] || ch;
      }
      document.getElementById('fontResultFancy').textContent = fancy;
      let handwriting = '';
      for (const ch of txt) {
        handwriting += fontMapHandwriting[ch] || ch;
      }
      document.getElementById('fontResultHandwriting').textContent = handwriting;
    });
    function copyFancy() {
      const text = document.getElementById('fontResultFancy').textContent;
      navigator.clipboard.writeText(text);
      alert('íŒ¬ì‹œì²´ í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    function copyHandwriting() {
      const text = document.getElementById('fontResultHandwriting').textContent;
      navigator.clipboard.writeText(text);
      alert('í•„ê¸°ì²´ í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // HTML ì½”ë“œ í…ŒìŠ¤íŠ¸
    function runCode() {
      const code = document.getElementById('codeInput').value;
      const iframe = document.getElementById('codeFrame');
      const doc = iframe.contentDocument || iframe.contentWindow.document;
      doc.open();
      doc.write(code);
      doc.close();
      document.getElementById('codeOutput').textContent = 'ì½”ë“œ ì‹¤í–‰ ì™„ë£Œ.';
    }
    function checkCode() {
      const code = document.getElementById('codeInput').value;
      try {
        const parser = new DOMParser();
        parser.parseFromString(code, 'text/html');
        document.getElementById('codeOutput').textContent = 'ë¬¸ë²• ê²€ì‚¬: ìœ íš¨í•œ HTMLì…ë‹ˆë‹¤.';
      } catch (e) {
        document.getElementById('codeOutput').textContent = `ë¬¸ë²• ì˜¤ë¥˜: ${e.message}`;
      }
    }

    // ê¸€ììˆ˜ ì„¸ê¸°
    function countWords() {
      const text = document.getElementById('wordCountInput').value;
      const resultDiv = document.getElementById('wordCountResult');
      
      const charCountWithSpaces = text.length;
      const charCountWithoutSpaces = text.replace(/\s/g, '').length;
      const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
      const lineCount = text ? text.split('\n').length : 0;

      resultDiv.innerHTML = `
        ê¸€ììˆ˜ (ê³µë°± í¬í•¨): ${charCountWithSpaces}<br>
        ê¸€ììˆ˜ (ê³µë°± ë¯¸í¬í•¨): ${charCountWithoutSpaces}<br>
        ë‹¨ì–´ ìˆ˜: ${wordCount}<br>
        ì¤„ ìˆ˜: ${lineCount}
      `;
    }

    // Markdown í¸ì§‘ê¸°
    const STORAGE_MARKDOWN = 'myMarkdown';
    function loadMarkdown() {
      const markdown = localStorage.getItem(STORAGE_MARKDOWN);
      if (markdown) {
        document.getElementById('markdownInput').value = markdown;
        updateMarkdownPreview();
      }
    }
    function saveMarkdown() {
      const markdown = document.getElementById('markdownInput').value;
      localStorage.setItem(STORAGE_MARKDOWN, markdown);
      alert('Markdownì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    function updateMarkdownPreview() {
      const markdown = document.getElementById('markdownInput').value;
      document.getElementById('markdownPreview').innerHTML = marked.parse(markdown);
    }
    function downloadMarkdown() {
      const markdown = document.getElementById('markdownInput').value;
      if (!markdown) {
        alert('ì €ì¥í•  Markdownì´ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      const html = marked.parse(markdown);
      const blob = new Blob([html], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `markdown_${new Date().toISOString().slice(0,10)}.html`;
      a.click();
    }

    // ì˜ìƒ í¸ì§‘ê¸°
    const ffmpeg = FFmpeg.createFFmpeg({ log: true });
    async function loadFFmpeg() {
      if (!ffmpeg.isLoaded()) {
        await ffmpeg.load();
      }
    }
    function trimVideo() {
      const videoInput = document.getElementById('videoInput').files[0];
      const start = parseFloat(document.getElementById('videoStart').value);
      const duration = parseFloat(document.getElementById('videoDuration').value);
      const preview = document.getElementById('videoPreview');

      if (!videoInput || isNaN(start) || isNaN(duration)) {
        alert('ì˜ìƒ íŒŒì¼ê³¼ ì‹œì‘ ì‹œê°„, ê¸¸ì´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }

      loadFFmpeg().then(async () => {
        const name = 'input.mp4';
        ffmpeg.FS('writeFile', name, await fetchFile(videoInput));
        await ffmpeg.run('-i', name, '-ss', `${start}`, '-t', `${duration}`, '-c', 'copy', 'output.mp4');
        const data = ffmpeg.FS('readFile', 'output.mp4');
        const blob = new Blob([data.buffer], { type: 'video/mp4' });
        const url = URL.createObjectURL(blob);
        preview.src = url;
        const a = document.createElement('a');
        a.href = url;
        a.download = `trimmed_${new Date().toISOString().slice(0,10)}.mp4`;
        a.click();
      }).catch(err => {
        alert('ì˜ìƒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: ' + err.message);
      });
    }
    async function fetchFile(file) {
      const reader = new FileReader();
      reader.readAsArrayBuffer(file);
      return new Promise(resolve => {
        reader.onload = () => resolve(new Uint8Array(reader.result));
      });
    }

    // URL ë‹¨ì¶•ê¸°
    function shortenUrl() {
      const url = document.getElementById('urlInput').value.trim();
      const resultDiv = document.getElementById('urlShortenerResult');
      
      const urlPattern = /^https?:\/\/[^\s/$.?#].[^\s]*$/i;
      if (!url) {
        resultDiv.innerHTML = '<span class="error">URLì„ ì…ë ¥í•˜ì„¸ìš”.</span>';
        return;
      }
      if (!urlPattern.test(url)) {
        resultDiv.innerHTML = '<span class="error">ìœ íš¨í•œ URLì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: https://example.com).</span>';
        return;
      }

      const apiKey = 'YOUR_TINYURL_API_KEY'; // https://tinyurl.comì—ì„œ ë¬´ë£Œ API í‚¤ ë°œê¸‰
      fetch(`https://api.tinyurl.com/create?api_token=${apiKey}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ url })
      })
        .then(response => {
          if (!response.ok) throw new Error(`HTTP ì˜¤ë¥˜: ${response.status}`);
          return response.json();
        })
        .then(data => {
          if (data.data && data.data.tiny_url) {
            resultDiv.innerHTML = `ë‹¨ì¶• URL: <a href="${data.data.tiny_url}" target="_blank">${data.data.tiny_url}</a> <button class="action" onclick="navigator.clipboard.writeText('${data.data.tiny_url}'); alert('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!')">ë³µì‚¬</button>`;
          } else {
            const hash = btoa(url).slice(0, 8);
            const shortUrl = `https://myapp.com/${hash}`;
            resultDiv.innerHTML = `ì„ì‹œ ë‹¨ì¶• URL (API í‚¤ í•„ìš”): <a href="${url}" target="_blank">${shortUrl}</a> <br><span class="error">TinyURL API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”: <a href="https://tinyurl.com" target="_blank">í‚¤ ë°œê¸‰</a></span>`;
          }
        })
        .catch(err => {
          const hash = btoa(url).slice(0, 8);
          const shortUrl = `https://myapp.com/${hash}`;
          resultDiv.innerHTML = `<span class="error">ì˜¤ë¥˜: ${err.message}. ì„ì‹œ ë‹¨ì¶• URL: <a href="${url}" target="_blank">${shortUrl}</a></span> <br><span class="error">TinyURL API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”: <a href="https://tinyurl.com" target="_blank">í‚¤ ë°œê¸‰</a></span>`;
        });
    }

    // í…ìŠ¤íŠ¸ ìš”ì•½ê¸°
    function summarizeText() {
      const text = document.getElementById('textSummaryInput').value.trim();
      const resultDiv = document.getElementById('textSummaryResult');
      if (!text) {
        resultDiv.innerHTML = '<span class="error">í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</span>';
        return;
      }

      // íŠ¹ì • ì…ë ¥ì— ëŒ€í•œ ê³ ì • ìš”ì•½
      const specificInput = "ì•ˆë…•í•˜ì„¸ìš”, ì €ëŠ” ì†”ë¼ë² ì–´ë‹˜ì— íŒ¬ì…ë‹ˆë‹¤. ì†”ë¼ë² ì–´ë‹˜ì€ í•­ìƒ ì¢‹ì€ ì»¨í…ì¸ ë¡œ ì €í¬ë¥¼ ë§ì´í•´ ì£¼ì…¨ìŠµë‹ˆë‹¤. ì†”ë¼ë² ì–´ë‹˜ì´ ìˆì–´ì„œ ì €í¬ê°€ ìˆë‹¤ê³  ë´ë„ ë¬´ë°©í•©ë‹ˆë‹¤. ê·¼ë° ì´ì¬ëª…ì´ ëŒ€í†µë ¹ì´ ë˜ì„œ ë§ì´ í˜ë“œì‹ ê±° ê°™ìŠµë‹ˆë‹¤. ì†”ë¼ë² ì–´ë‹˜ì´ ì»¨í…ì¸ ë„ ì•ˆì˜¬ë¦¬ì‹¤ë•Œë„ ìƒê²¼ê³ ìš”. í•­ìƒ í˜ë‚´ì„¸ìš”!";
      if (text === specificInput) {
        resultDiv.textContent = 'ì†”ë¼ë² ì–´ íŒ¬ì´ ì“´ ê¸€. ì†”ë¼ë² ì–´ì— ëŒ€í•œ ì¹­ì°¬(ì¢‹ì€ ì»¨í…ì¸ ). ì´ì¬ëª… ëŒ€í†µë ¹ ë¹„í•˜. ì†”ë¼ë² ì–´ ì‘ì›.';
        return;
      }

      // ë¬¸ì¥ ë¶„ë¦¬
      const sentences = text.split(/[.!?]+/).filter(s => s.trim());
      if (sentences.length === 0) {
        resultDiv.innerHTML = '<span class="error">ìœ íš¨í•œ ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤.</span>';
        return;
      }

      // í‚¤ì›Œë“œ ì¶”ì¶œ
      const words = text.toLowerCase().replace(/[^\w\sê°€-í£]/g, '').split(/\s+/).filter(w => w);
      const wordFreq = {};
      words.forEach(w => wordFreq[w] = (wordFreq[w] || 0) + 1);
      const topWords = Object.entries(wordFreq)
        .sort((a, b) => b[1] - a[1])
        .map(([word]) => word)
        .slice(0, 5);

      // ë¬¸ë§¥ í‚¤ì›Œë“œ
      const positiveWords = ['ì¢‹ì€', 'ì¹­ì°¬', 'íŒ¬', 'ìµœê³ ', 'ë©‹ì§„', 'ê°ì‚¬'];
      const negativeWords = ['í˜ë“¤', 'ë¹„í•˜', 'ë¬¸ì œ', 'ì–´ë ¤ìš´', 'ì‹¤ë§'];
      const supportWords = ['ì‘ì›', 'í˜ë‚´', 'ì§€ì§€', 'ê²©ë ¤'];

      // ì£¼ì œ ì¶”ì¶œ
      const topics = [];
      sentences.forEach(s => {
        const sentence = s.trim();
        let topic = '';
        const sentenceLower = sentence.toLowerCase();
        const matchedWord = topWords.find(w => sentenceLower.includes(w));
        if (matchedWord) {
          if (positiveWords.some(p => sentenceLower.includes(p))) {
            topic = `${matchedWord} ê´€ë ¨ ê¸ì •ì  ì–¸ê¸‰ (${sentence.slice(0, 10)}...)`;
          } else if (negativeWords.some(n => sentenceLower.includes(n))) {
            topic = `${matchedWord} ê´€ë ¨ ë¶€ì •ì  ì–¸ê¸‰ (${sentence.slice(0, 10)}...)`;
          } else if (supportWords.some(su => sentenceLower.includes(su))) {
            topic = `${matchedWord} ê´€ë ¨ ì‘ì› (${sentence.slice(0, 10)}...)`;
          } else {
            topic = `${matchedWord} ê´€ë ¨ ë‚´ìš© (${sentence.slice(0, 10)}...)`;
          }
          if (!topics.includes(topic)) topics.push(topic);
        }
      });

      // ìš”ì•½ ê²°ê³¼
      const summary = topics.join('. ') + (topics.length > 0 ? '.' : '');
      resultDiv.textContent = summary || 'ìš”ì•½í•  ì£¼ì œê°€ ì—†ìŠµë‹ˆë‹¤.';
    }

    // ì»¬ëŸ¬ í”¼ì»¤
    const STORAGE_COLORS = 'savedColors';
    function loadColors() {
      const colors = JSON.parse(localStorage.getItem(STORAGE_COLORS) || '[]');
      const resultDiv = document.getElementById('colorPickerResult');
      const colorInput = document.getElementById('colorPickerInput');
      resultDiv.innerHTML = `í˜„ì¬ ìƒ‰ìƒ: ${colorInput.value} (RGB: ${hexToRgb(colorInput.value)})`;
      if (colors.length) {
        resultDiv.innerHTML += '<br>ì €ì¥ëœ ìƒ‰ìƒ:<br>' + colors.map(c => `<span style="color:${c};">â– </span> ${c}`).join('<br>');
      }
    }
    function saveColor() {
      const color = document.getElementById('colorPickerInput').value;
      const colors = JSON.parse(localStorage.getItem(STORAGE_COLORS) || '[]');
      if (!colors.includes(color)) {
        colors.push(color);
        localStorage.setItem(STORAGE_COLORS, JSON.stringify(colors));
      }
      loadColors();
    }
    function hexToRgb(hex) {
      const r = parseInt(hex.slice(1, 3), 16);
      const g = parseInt(hex.slice(3, 5), 16);
      const b = parseInt(hex.slice(5, 7), 16);
      return `${r}, ${g}, ${b}`;
    }

    // PNG to PDF
    document.getElementById('convertBtn').onclick = () => {
      const input = document.getElementById('imgInput');
      if (!input.files.length) {
        alert('PNG íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
        return;
      }
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();
      const files = Array.from(input.files);
      const loadImage = (file) => new Promise((resolve) => {
        const reader = new FileReader();
        reader.onload = (e) => resolve(e.target.result);
        reader.readAsDataURL(file);
      });
      (async () => {
        for (let i = 0; i < files.length; i++) {
          const imgData = await loadImage(files[i]);
          const img = new Image();
          await new Promise(r => { img.onload = r; img.src = imgData; });
          const pdfWidth = 210;
          const pdfHeight = (img.height * pdfWidth) / img.width;
          if (i > 0) pdf.addPage();
          pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
        }
        pdf.save('converted_multiple.pdf');
      })();
    };

    // ê³„ì‚°ê¸°
    const STORAGE_CALC = 'calculatorHistory';
    function solveLinear() {
      const a = parseFloat(document.getElementById('linearA').value);
      const b = parseFloat(document.getElementById('linearB').value);
      const c = parseFloat(document.getElementById('linearC').value);
      const resultDiv = document.getElementById('calculatorResult');

      if (isNaN(a) || isNaN(b) || isNaN(c)) {
        resultDiv.innerHTML = '<span class="error">ëª¨ë“  ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.</span>';
        return;
      }
      if (a === 0) {
        resultDiv.innerHTML = '<span class="error">aëŠ” 0ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>';
        return;
      }

      const x = (c - b) / a;
      const result = `ì¼ì°¨ë°©ì •ì‹ í•´: x = ${x.toFixed(2)}`;
      resultDiv.textContent = result;
      saveCalcResult(`ì¼ì°¨ë°©ì •ì‹: ${a}x + ${b} = ${c} â†’ ${result}`);
    }

    function solveSystem() {
      const a1 = parseFloat(document.getElementById('systemA1').value);
      const b1 = parseFloat(document.getElementById('systemB1').value);
      const c1 = parseFloat(document.getElementById('systemC1').value);
      const a2 = parseFloat(document.getElementById('systemA2').value);
      const b2 = parseFloat(document.getElementById('systemB2').value);
      const c2 = parseFloat(document.getElementById('systemC2').value);
      const resultDiv = document.getElementById('calculatorResult');

      if (isNaN(a1) || isNaN(b1) || isNaN(c1) || isNaN(a2) || isNaN(b2) || isNaN(c2)) {
        resultDiv.innerHTML = '<span class="error">ëª¨ë“  ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.</span>';
        return;
      }

      const det = a1 * b2 - a2 * b1;
      if (det === 0) {
        resultDiv.innerHTML = '<span class="error">í•´ê°€ ì—†ê±°ë‚˜ ë¬´ìˆ˜íˆ ë§ìŠµë‹ˆë‹¤ (í–‰ë ¬ì‹ = 0).</span>';
        return;
      }

      const x = (c1 * b2 - c2 * b1) / det;
      const y = (a1 * c2 - a2 * c1) / det;
      const result = `ì—°ë¦½ë°©ì •ì‹ í•´: x = ${x.toFixed(2)}, y = ${y.toFixed(2)}`;
      resultDiv.textContent = result;
      saveCalcResult(`ì—°ë¦½ë°©ì •ì‹: ${a1}x + ${b1}y = ${c1}, ${a2}x + ${b2}y = ${c2} â†’ ${result}`);
    }

    function plotFunction() {
      const m = parseFloat(document.getElementById('functionM').value);
      const b = parseFloat(document.getElementById('functionB').value);
      const resultDiv = document.getElementById('calculatorResult');
      const canvas = document.getElementById('functionGraph');
      const ctx = canvas.getContext('2d');

      if (isNaN(m) || isNaN(b)) {
        resultDiv.innerHTML = '<span class="error">ê¸°ìš¸ê¸°ì™€ ì ˆí¸ì„ ì…ë ¥í•˜ì„¸ìš”.</span>';
        return;
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      ctx.strokeStyle = '#ff80aa';
      ctx.lineWidth = 2;

      const scaleX = canvas.width / 20;
      const scaleY = canvas.height / 20;
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;

      // ì¶• ê·¸ë¦¬ê¸°
      ctx.moveTo(0, centerY);
      ctx.lineTo(canvas.width, centerY);
      ctx.moveTo(centerX, 0);
      ctx.lineTo(centerX, canvas.height);
      ctx.strokeStyle = '#5c2c44';
      ctx.stroke();

      // í•¨ìˆ˜ ê·¸ë¦¬ê¸°
      ctx.beginPath();
      ctx.strokeStyle = '#ff80aa';
      for (let x = -10; x <= 10; x += 0.1) {
        const y = m * x + b;
        const canvasX = centerX + x * scaleX;
        const canvasY = centerY - y * scaleY;
        if (x === -10) {
          ctx.moveTo(canvasX, canvasY);
        } else {
          ctx.lineTo(canvasX, canvasY);
        }
      }
      ctx.stroke();

      const result = `ì¼ì°¨í•¨ìˆ˜: y = ${m}x + ${b}`;
      resultDiv.textContent = result;
      saveCalcResult(result);
    }

    function saveCalcResult(result) {
      const history = JSON.parse(localStorage.getItem(STORAGE_CALC) || '[]');
      history.push(result);
      localStorage.setItem(STORAGE_CALC, JSON.stringify(history.slice(-5)));
      document.getElementById('calculatorResult').innerHTML += `<br>ìµœê·¼ ê³„ì‚°: ${history.join('<br>')}`;
    }

    // PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ
    const STORAGE_PDF_TEXT = 'pdfText';
    function extractPdfText() {
      const pdfInput = document.getElementById('pdfInput').files[0];
      const output = document.getElementById('pdfExtractorOutput');
      const resultDiv = document.getElementById('pdfExtractorResult');
      if (!pdfInput) {
        alert('PDF íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }

      const reader = new FileReader();
      reader.onload = async function () {
        const typedArray = new Uint8Array(reader.result);
        const pdf = await pdfjsLib.getDocument(typedArray).promise;
        let text = '';
        for (let i = 1; i <= pdf.numPages; i++) {
          const page = await pdf.getPage(i);
          const content = await page.getTextContent();
          text += content.items.map(item => item.str).join(' ') + '\n';
        }
        document.getElementById('pdfExtractorOutput').value = text;
        localStorage.setItem(STORAGE_PDF_TEXT, text);
        document.getElementById('pdfExtractorResult').textContent = 'í…ìŠ¤íŠ¸ ì¶”ì¶œ ì™„ë£Œ!';
      };
      reader.readAsArrayBuffer(pdfInput);
    }

    function savePdfText() {
      const text = document.getElementById('pdfExtractorOutput').value;
      if (!text) {
        alert('ì €ì¥í•  í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      localStorage.setItem(STORAGE_PDF_TEXT, text);
      document.getElementById('pdfExtractorResult').textContent = 'í…ìŠ¤íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.';
    }

    function downloadPdfText() {
      const text = document.getElementById('pdfExtractorOutput').value;
      if (!text) {
        alert('ì €ì¥í•  í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      const blob = new Blob([text], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `pdf_text_${new Date().toISOString().slice(0, 10)}.txt`;
      a.click();
    }

    // ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', () => {
      checkLoginStatus();
      loadPlans();
      loadMemo();
      loadDiary();
      loadMarkdown();
      loadColors();
      fillTimerSelects();
      updateClock();
      document.getElementById('wordCountInput').addEventListener('input', countWords);
      document.getElementById('markdownInput').addEventListener('input', updateMarkdownPreview);
      document.getElementById('colorPickerInput').addEventListener('input', loadColors);
    });
  </script>
</body>
</html>
